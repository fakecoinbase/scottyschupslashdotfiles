# My custom shell functions, most of which should probably be scripts in a bin somewhere. A project for another day

function cd_atom {
  cd $1 && atom .
}

function cd_ll {
  cd $1 && k -Ah
}

function git_add_commit {
  if [ $2 ]; then
    g_add=$1
    g_msg=$2
  else
    return "Enter a commit message"
  fi
  git add $g_add; git commit -m $g_msg;
}

function git_add_commit_push {
  gac $1 $2
  g_branch=$(git rev-parse --symbolic-full-name --abbrev-ref HEAD)
  git push -u origin $g_branch
}

function git_branch_delete_remote {
  if [ $2 ]; then
    remote=$1
    branch=$2
  else
    remote='origin'
    branch=$1
  fi
  git push $remote --delete $branch
}

function git_commit_push {
  git commit -m $1 && git push
}

function git_diff_file {
  if [ $3 ]; then
    commit2=$3
  else
    commit2="HEAD"
  fi

  if [ $2 ]; then
    file=$1
    commit1=$2
    git diff $commit1 $commit2 $file
  else
    echo "Usage: git_diff_file COMMIT FILE_NAME" >&2; exit 1
  fi
}

function git_ignore_and_remove {
  echo $1 >> ./.gitignore; git rm --cached $1
}

function git_lastnhashes {
  git rev-list --max-count=$1 HEAD
}

function mkdir_cd {
  if [ ! -n "$1" ]; then
    echo "Enter a directory name"
  elif [ -d $1 ]; then
    echo "\`$1' already exists"
  else
    mkdir $1 && cd $1
  fi
}

function omni_killer {
  for pid in $(pids_for $1); do
    kill -9 $pid;
  done
}

function pids_for {
  ps aux |
  grep $1 |
  grep -v grep |
  awk '{print $2}' |
  tr '\n' ' ' |
  sed 's/\s$//'
}

function ping_google {
  if [ ! -n "$1" ]; then
    ping -c 5 google.com
  else
    ping -c $1 google.com
  fi
}

function rails_reset {
  mysql.server restart &&
  export RAILS_ENV="development" &&
  bundle install &&
  rake db:drop &&
  rake db:create &&
  rake db:migrate &&
  rake db:seed &&
  rails server
}

function untarAll {
  for file in $( ls ); do
    dir=${file%.tar};
    mkdir $dir;
    tar -C $dir/ -xvf $file;
  done
}

function untargzAll {
   for file in $( ls ); do
    dir=${file%.tar};
    mkdir $dir;
    tar -C $dir/ -zxvf $file;
  done
}

function which_cd {
  cd `which $1 | xargs dirname`
}

function which_cd_ll {
  cd `which $1 | xargs dirname` && k -Ah
}

function z_atom {
  z $1 && atom .
}

function z_ll {
  z $1 && k -Ah
}
